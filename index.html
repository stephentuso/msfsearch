
<!DOCTYPE html>
<html>
<head>
    <script type="text/javascript" src="js/jquery-3.0.0.min.js"></script>
    <script type="text/javascript" src="bower_components/double-metaphone/index.js"></script>
    <script type="text/javascript" src="js/fuse.js"></script>
    <script type="text/javascript" src="js/main.js"></script>
    <script type="text/javascript" src="js/simple-excel.js"></script>
    <link rel="stylesheet" href="css/main.css">
</head>
<body>
    <img src="dwb.jpg">

    <div id="mainBox">
        <label class="selectFile">
            <input type="file" id="files" name="files[]" multiple required>
            <span>Select File</span>
        </label>
    </div>
    <ul id="fileList">
    </ul>

    <script>
        var allData = [];
        function handleFileSelect(evt) {
            var files = evt.target.files; // FileList object
            for (var i = 0; i < files.length; i++) {
                (function(index) {
                    parseCsvFile(files[index], function(data) {
                        console.log(data);
                        allData = allData.concat(data);
                        var text = $("<li></li>").text(files[index].name)
                        $('#fileList').append(text)
                        if (index == files.length - 1) {
                            doneProcessing();
                        }
                    });
                })(i);
            }
        }

        function doneProcessing() {
            window.localStorage.setItem("allData", allData);
            console.log("DONE");
        }

        document.getElementById('files').addEventListener('change', handleFileSelect, false);
    </script>
</body>
</html>
