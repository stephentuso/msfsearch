
<!DOCTYPE html>
<html>
<head>
    <script type="text/javascript" src="js/jquery-3.0.0.min.js"></script>
    <script type="text/javascript" src="bower_components/double-metaphone/index.js"></script>
    <script type="text/javascript" src="js/fuse.js"></script>
    <script type="text/javascript" src="js/main.js"></script>
    <script type="text/javascript" src="js/simple-excel.js"></script>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/bootstrap.min.css">

    <!-- <link rel="stylesheet" href="css/main.css"> -->
</head>
<body>
    <div class="container">
        <div class="row" id="topheader">
            <div class="align-center">
                <img src="dwb.jpg" id="dwbimage" class="img-responsive center-block logo">
            </div>
        </div>
        <div class="row">
            <div id="mainBox" class="align-center">
                <label class="btn btn-danger center-block" id="filebutton">
                    Select Files
                    <input type="file" style="display: none;" id="files" value="Select File">
                </label>
            </div>
        </div>
        <div class="row">
            <ul class="align-center" id="fileList">

            </ul>
        </div>
    </div>
    <script>
        var allData = [];
        function handleFileSelect(evt) {
            var files = evt.target.files; // FileList object
            for (var i = 0; i < files.length; i++) {
                (function(index) {
                    parseCsvFile(files[index], function(data) {
                        console.log(data);
                        allData = allData.concat(data);
                        var text = $("<li class='text-center'></li>").text(files[index].name)
                        $('#fileList').append(text)
                        if (index == files.length - 1) {
                            doneProcessing();
                        }
                    });
                })(i);
            }
        }

        function doneProcessing() {
            window.localStorage.setItem("allData", allData);
            console.log("DONE");
            processFiles(files);
        }

        document.getElementById('files').addEventListener('click', handleFileSelect, false);
    </script>
</body>
</html>
