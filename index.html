
<!DOCTYPE html>
<html>
<head>
    <script type="text/javascript" src="js/jquery-3.0.0.min.js"></script>
    <script type="text/javascript" src="bower_components/double-metaphone/index.js"></script>
    <script type="text/javascript" src="js/fuse.js"></script>
    <script type="text/javascript" src="js/main.js"></script>
    <script type="text/javascript" src="js/simple-excel.js"></script>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="shortcut icon" href="icon.jpg" />

    <!-- <link rel="stylesheet" href="css/main.css"> -->


</head>
<body>
    <div class="container">
        <div class="row" id="topheader">
            <div class="align-center">
                <img src="dwb.png" id="dwbimage" class="img-responsive center-block logo">
            </div>
        </div>

        <div class="row" style="top: 50%; left: 50%;">
            <p style="text-align:center;width:100%;font-size: 33px;"><b>NAME SEARCH<b></p>

            <p style= "text-align:center; width:40%; margin: 0 auto; font-size: 20px;">Search a database phonetically, quickly and, easily. Find results that sound the same but are spelled differently.</p>
            <br/>
            <br/>
            <p style= "text-align:center; width:100%; font-size: 20px;">Start by uploading your files.</p>
            <br/>
        </div>
        <div class="row">
            <div id="mainBox" class="align-center">
                <label class="btn btn-danger center-block" id="filebutton">
                    Select Files
                    <input type="file" style="display: none;" id="files" value="Select File">
                </label>
            </div>
        </div>
        <div class="row">
            <ul class="align-center" id="fileList">
            </ul>
        </div>
        <label class="btn btn-primary" id="nextbutton">
            <span class="glyphicon glyphicon-arrow-right" aria-hidden="true"></span>
            <p>Next</p>
        </label>
    </div>
    <script>
        var allData = [];
        var file_list = [];
        $('#nextbutton').hide();
        function handleFileSelect(evt) {
            var files = evt.target.files; // FileList object

            for (var i = 0; i < files.length; i++) {
                file_list.push(files[i])
                var text = $("<li class='text-center'><button class='glyphicon glyphicon-remove' onclick='deleteFile(event)'></button>&nbsp;"+ files[i].name + "</li>").hide()
                $('#fileList').append(text);
                text.fadeIn(500);
                (function(index) {
                    parseCsvFile(files[index], function(data) {
                        console.log(data);
                        allData = allData.concat(data);

                        if (index == files.length - 1) {
                            doneProcessing();
                        }
                    });
                })(i);
            }
            $('#nextbutton').fadeIn(500);
        }

        function doneProcessing() {
            window.localStorage.setItem("allData", allData);
            console.log("DONE");
            processFiles(files);
        }

        document.getElementById('files').addEventListener('change', handleFileSelect, false);
        function deleteFile(event) {
            var remove_name = $(event.target).parent().text().trim()
            $(event.target).parent().fadeOut(500)
            for (var i=0; i<file_list.length; i ++) {
                if (file_list[i].name == remove_name) {
                    file_list.splice(i, 1)
                    break
                }
            }
            if (file_list.length == 0) {
                $('#nextbutton').fadeOut(500);
            }
        }
    </script>
</body>
</html>

<!--

  _o/
    \
    /\_,
    \
    '

-->
